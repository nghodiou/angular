(window.webpackJsonp=window.webpackJsonp||[]).push([[250],{"0MGa":function(e,t,i){"use strict";i("cBR7")},"5G5B":function(e,t,i){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"member-item",class:{clicklable:!!e.onClick},on:{click:function(t){e.onClick&&e.onClick(e.member)}}},[t("div",{staticClass:"member"},[t("vue-avatar",e._b({attrs:{text:e.member&&(e.member.fullname||e.member[e.showLabel])||"",src:e.photo||"",color:"white",size:e.size,rounded:!0}},"vue-avatar",!e.member&&{backgroundColor:"#d4d4d4"},!1)),e._v(" "),e.member&&e.roles[e.member.role]?t("i-icon",{staticClass:"rosette",attrs:{solid:"",color:e.roles[e.member.role].color,icon:e.roles[e.member.role].icon}}):e._e()],1),e._v(" "),e.showLabel?t("span",{staticClass:"member-label"},[e._v("\n\t\t"+e._s(e.member[e.showLabel])+"\n\t")]):e._e()])};o._withStripped=!0;var r=i("NRfZ"),s=i("ttAG"),a={props:{member:Object,showLabel:String,onClick:Function,size:{type:Number,default:32}},data:function(){return{roles:{owner:{color:"#ffce00",icon:"crown"},manager:{color:"#11c4e0",icon:"angle-double-up"},editor:{color:"#11c4e0",icon:"angle-up"}}}},computed:{photo:function(){return this.member&&this.member.photo?s.default.isProfilePhotoId(this.member.photo)?r.a.fileApi+"/photo/"+this.member.photo:this.member.photo:null}}},n=(i("MeWj"),i("KHd+")),l=Object(n.a)(a,o,[],!1,null,"1cca53ac",null);t.a=l.exports},"8zLQ":function(e,t,i){},"93E0":function(e,t,i){var o=i("LboF"),r=i("znhZ");"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s={insert:"head",singleton:!1};o(r,s);e.exports=r.locals||{}},MeWj:function(e,t,i){"use strict";i("uzxi")},UPqQ:function(e,t,i){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"select-role-wrapper",class:{"member-list":e.memberList}},[e._t("default"),e._v(" "),!e.$can("invite-user")||e.disableChangeRole||"owner"===e.value?t("span",[e._v(e._s(this.selectedRole&&this.selectedRole.text||e.$t("teamMember.owner")))]):t("i-select",{directives:[{name:"can",rawName:"v-can",value:"role-edit",expression:"'role-edit'"}],class:{naked:e.naked},attrs:{items:e.roles,readonly:"owner"===e.value,emptyOption:"Owner",tabindex:"-1"},on:{change:e.onChanged,click:function(t){return e.$emit("click",t)}},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{class:{[i.item.color]:!0}},[e._v(e._s(i.item.text))])]}},{key:"input",fn:function(i){return[t("div",{staticClass:"f-select"},[i.item?[e._v("\n\t\t\t\t\t"+e._s(i.item.text)+"\n\t\t\t\t")]:[t("span",{staticClass:"default-text"},[e._v(e._s(e.$t("teamMember.owner")))])]],2)]}}]),model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}})],2)};o._withStripped=!0;var r={props:{value:{type:String,default:"manager"},naked:Boolean,memberList:Boolean,deleteEnable:Boolean,disableChangeRole:Boolean},data:function(){var e=[{text:this.$t("teamMember.manager"),value:"manager"},{text:this.$t("teamMember.editor"),value:"editor"},{text:this.$t("teamMember.viewer"),value:"viewer"}];return this.deleteEnable&&e.push({text:this.$t("teamMember.removeFromTheFolder"),value:"remove",color:"red"}),{selectedRole:e.find(e=>e.value===this.value),roles:e}},methods:{onChanged:function(e){"remove"===e.value?this.$nextTick(()=>{this.$set(this,"selectedRole",this.roles.find(e=>e.value===this.value))}):this.$emit("input",e.value),this.$emit("change",e.value)}}},s=(i("0MGa"),i("KHd+")),a=Object(s.a)(r,o,[],!1,null,"7994bb73",null);t.a=a.exports},Xsm7:function(e,t,i){},YJ4K:function(e,t,i){var o=i("LboF"),r=i("8zLQ");"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s={insert:"head",singleton:!1};o(r,s);e.exports=r.locals||{}},cBR7:function(e,t,i){var o=i("LboF"),r=i("Xsm7");"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s={insert:"head",singleton:!1};o(r,s);e.exports=r.locals||{}},cLlD:function(e,t,i){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"member-folder-list-wrapper",class:{loading:e.showProgress}},[e.showProgress?t("i-preloader"):e.member&&e.member.folders?e._l(e.member.folders,(function(i,o){return t("SelectRole",{key:o,attrs:{naked:"",memberList:"",deleteEnable:"",disableChangeRole:e.disableChangeRole},on:{change:function(t){return e.onChangedRole(i,e.member,t)}},model:{value:i.role,callback:function(t){e.$set(i,"role",t)},expression:"folder.role"}},[t("FolderItem",{attrs:{folder:i,icon:"folder",solid:"",naked:""}})],1)})):e._e()],2)};o._withStripped=!0;var r,s,a,n=i("yXPU"),l=i.n(n),d=i("BWiC"),m=i("UPqQ"),u=i("jkf8"),c={components:{SelectRole:m.a,FolderItem:u.a},props:{member:Object,autoGetMemberFolders:Boolean,folders:Array,disableChangeRole:Boolean},data:function(){return{showProgress:!1}},mounted:function(){this.autoGetMemberFolders&&this.getMemberFolders()},methods:{getMemberFolders:(a=l()((function*(){this.showProgress=!0;var e=(yield d.a.getUserFolders(this.member.userId)).map(e=>({_id:e.folderId,name:e.folderName,color:e.folderColor,ownerId:e.ownerId,role:e.role}));this.$set(this.member,"folders",e),this.showProgress=!1})),function(){return a.apply(this,arguments)}),removeMemberFromFolder:(s=l()((function*(e,t){var i=this;this.$swal({title:this.$t("areYouSure"),text:this.$t("teamMember.removeFromFolder"),icon:"warning",showCancelButton:!0,cancelButtonText:this.$t("cancel"),confirmButtonText:this.$t("popups.deleteFormPopup.okButtonText")}).then(function(){var o=l()((function*(o){if(o.value&&(yield d.a.deleteUserFromFolder(i.$root.user._id,e.userId,t))){e.folders.splice(e.folders.findIndex(e=>e._id===t),1);var r=i.folders.find(e=>e._id===t);r.members.splice(r.members.findIndex(t=>t.userId===e.userId),1)}}));return function(e){return o.apply(this,arguments)}}())})),function(e,t){return s.apply(this,arguments)}),onChangedRole:(r=l()((function*(e,t,i){if("remove"!==i){var o=yield d.a.updateRole(e.ownerId,e._id,t.userId,i);t.userId===this.$root.user._id&&(this.$root.roleName=i);var r=this.folders.find(t=>t._id===e._id);return r&&r.members&&(r.members.find(e=>e.userId===t.userId).role=i),o}yield this.removeMemberFromFolder(t,e._id)})),function(e,t,i){return r.apply(this,arguments)})}},f=(i("cfu5"),i("KHd+")),h=Object(f.a)(c,o,[],!1,null,"0ce41e64",null);t.a=h.exports},cfu5:function(e,t,i){"use strict";i("YJ4K")},qxNJ:function(e,t,i){},uUSi:function(e,t,i){"use strict";i("93E0")},uzxi:function(e,t,i){var o=i("LboF"),r=i("qxNJ");"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s={insert:"head",singleton:!1};o(r,s);e.exports=r.locals||{}},wBFq:function(e,t,i){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"invite-members-wrapper"},[t("div",[e.folder?t("p",{directives:[{name:"can",rawName:"v-can",value:"invite-user",expression:"'invite-user'"}],staticClass:"invite-title"},[t("i18n",{attrs:{path:"teamMember.inviteMembersTo"}},[t("b",{attrs:{place:"folderName"}},[e._v(e._s(e.folder.name))])])],1):t("p",{staticClass:"invite-title"},[e._v(e._s(e.$t("teamMember.invitemember")))]),e._v(" "),t("div",{directives:[{name:"can",rawName:"v-can",value:"invite-user",expression:"'invite-user'"}],staticClass:"invite-member-layout"},[t("ITags",{ref:"itags",class:{empty:e.emailList.length<=0},attrs:{validate:"email",placeholder:e.$t("teamMember.inviteText"),parseString:!0,textKey:"email",showPhoto:"",variables:e.membersList},on:{onChange:e.inActiveEmailListValidation},model:{value:e.emailList,callback:function(t){e.emailList=t},expression:"emailList"}}),e._v(" "),t("SelectRole",{on:{click:e.addNewEmail},model:{value:e.selectRole,callback:function(t){e.selectRole=t},expression:"selectRole"}})],1),e._v(" "),e.folder?e._e():t("div",{staticClass:"select-folder-wrapper"},[t("p",{staticClass:"invite-title"},[e._v(e._s(e.$t("teamMember.folders")))]),e._v(" "),t("i-select",{attrs:{items:e.folders,multiple:"",placeholder:e.$t("myForms.selectFolder"),"option-text":"name"},on:{open:function(t){return e.$emit("onSelectIsOpen",!0)},close:function(t){return e.$emit("onSelectIsOpen",!1)}},model:{value:e.selectedFolders,callback:function(t){e.selectedFolders=t},expression:"selectedFolders"}})],1)]),e._v(" "),t("div",{staticClass:"text-center"},[t("i-button",{directives:[{name:"can",rawName:"v-can",value:"invite-user",expression:"'invite-user'"}],staticClass:"invite-button",class:{"invite-button-start":!e.folder},attrs:{disabled:!e.emailList||0===e.emailList.length,loading:e.loading},on:{click:e.invite,disableClick:e.addNewEmail}},[e._v(e._s(e.$t("teamMember.invite")))])],1)])};o._withStripped=!0;var r,s,a=i("yXPU"),n=i.n(a),l=(i("4mDm"),i("5s+n"),i("3bBZ"),i("ua0s")),d=i("UPqQ"),m=i("iKgg"),u=Object(m.a)("quotas"),c={getTeamMemberQuotas:()=>n()((function*(){var e=yield u.get("teamMemberCount");return 200===e.status?e.data:0}))()},f=i("ttAG"),h=i("NRfZ"),v={components:{SelectRole:d.a,ITags:()=>Promise.all([i.e(26),i.e(148)]).then(i.bind(null,"aNEy"))},props:{folder:Object,folders:Array,members:Array,invitedMembers:Array},data:function(){return{selectedFolders:this.folder?[this.folder]:[],emailList:[],selectRole:"manager",loading:!1,quota:{q:0,u:0},ownerId:""}},mounted:(s=n()((function*(){this.folder&&this.$root.user._id!==this.folder.ownerId?(this.ownerId=this.folder.ownerId,this.$set(this,"quota",yield c.getTeamMemberQuotas())):(this.ownerId=this.$root.user._id,this.$set(this.quota,"q",this.$root.user.quotas.teamMemberCount.quota),this.$set(this.quota,"u",this.$root.user.quotas.teamMemberCount.used))})),function(){return s.apply(this,arguments)}),methods:{inActiveEmailListValidation:function(e){this.$nextTick(()=>{this.invitedMembers&&this.invitedMembers.find(t=>t.email===e)?this.emailList.splice(this.emailList.length-1,1):this.quota.q-this.quota.u-this.emailList.length<0&&(this.emailList.splice(this.emailList.length-1,1),this.$root.upgradePopup("teamMemberCount",{currentQuota:this.quota.q,ownerId:this.ownerId}))})},invite:(r=n()((function*(){var e=this;this.loading=!0;var t=[],i=this.selectedFolders.map(e=>({folderId:e._id,folderName:e.name,folderColor:e.color,role:this.selectRole})),o=l.a.invite;this.folder&&(o=l.a.inviteToFolder);for(var r=0;r<this.emailList.length;r++){var s={email:this.emailList[r].email,language:"en",folders:i};t.push({email:s.email,request:o(s)})}Promise.all(t.map(e=>e.request)).then(i=>{for(var o=function(o){var r=i[o];if(200===r.status){var s=r.data;if(s.success){if(s.teamInvitation&&!e.invitedMembers.find(e=>e.email===s.teamInvitation.email)&&(s.teamInvitation.folders&&(s.teamInvitation.folders=s.teamInvitation.folders.map(e=>({_id:e.folderId,name:e.folderName,color:e.folderColor,role:e.role}))),e.invitedMembers.push(s.teamInvitation)),s.teamAuthorizations)for(var a=function(){var t=s.teamAuthorizations[n],i=e.folders.find(e=>e._id===t.folderId);i&&(i.members=i.members||[],i.members.push(t))},n=0;n<s.teamAuthorizations.length;n++)a();e.emailList.splice(e.emailList.findIndex(e=>e.email===t[o].email),1),e.folder&&e.folder.ownerId!==e.$root.user._id||e.$root.user.quotas.teamMemberCount.used++,e.quota.u++}e.$root.pushNotification(e.$t("teamMember.state.sent"))}},r=0;r<i.length;r++)o(r);this.loading=!1,this.$emit("onInvited")})})),function(){return r.apply(this,arguments)}),addNewEmail:function(){this.$refs.itags.addNew()}},computed:{membersList:function(){var e=this,t=[];if(this.members&&this.members.length>0){var i=function(i){var o="";if(e.folder&&e.folder.members.find(e=>e.userId===i.userId))return 1;f.default.isProfilePhotoId(i.photo)&&(o=h.a.fileApi+"/photo/"+i.photo);var r=i.userId||i._id;r===e.$root.user._id||e.invitedMembers.find(e=>e.userId===r)||t.push({label:i.fullname,value:i.email,photo:o})};for(var o of this.members)i(o)}return t}}},b=(i("uUSi"),i("KHd+")),p=Object(b.a)(v,o,[],!1,null,"5731b5d2",null);t.a=p.exports},znhZ:function(e,t,i){}}]);